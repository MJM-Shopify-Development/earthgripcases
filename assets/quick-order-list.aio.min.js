/*
Generated time: February 1, 2025 16:26
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
customElements.get("quick-order-list-remove-button")||customElements.define("quick-order-list-remove-button",class extends BulkAdd{constructor(){super(),this.addEventListener("click",t=>{t.preventDefault(),this.startQueue(this.dataset.index,0)})}}),customElements.get("quick-order-list-remove-all-button")||customElements.define("quick-order-list-remove-all-button",class extends HTMLElement{constructor(){super(),this.quickOrderList=this.closest("quick-order-list");var t=this.quickOrderList.querySelectorAll("[data-quantity-variant-id]");let e={},i=!1;t.forEach(t=>{0<parseInt(t.dataset.cartQuantity)&&(i=!0,e[parseInt(t.dataset.quantityVariantId)]=0)}),i||this.classList.add("hidden"),this.actions={confirm:"confirm",remove:"remove",cancel:"cancel"},this.addEventListener("click",t=>{t.preventDefault(),this.dataset.action===this.actions.confirm?this.toggleConfirmation(!1,!0):this.dataset.action===this.actions.remove?(this.quickOrderList.updateMultipleQty(e),this.toggleConfirmation(!0,!1)):this.dataset.action===this.actions.cancel&&this.toggleConfirmation(!0,!1)})}toggleConfirmation(t,e){this.quickOrderList.querySelector(".quick-order-list-total__confirmation").classList.toggle("hidden",t),this.quickOrderList.querySelector(".quick-order-list-total__info").classList.toggle("hidden",e)}}),customElements.get("quick-order-list")||customElements.define("quick-order-list",class extends BulkAdd{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.quickOrderListId=this.dataset.section+"-"+this.dataset.productId,this.defineInputsAndQuickOrderTable(),this.variantItemStatusElement=document.getElementById("shopping-cart-variant-item-status");var t=this.querySelector("form"),e=(this.inputFieldHeight=this.querySelector(".variant-item__quantity-wrapper").offsetHeight,this.isListInsideModal=document.querySelector(".quick-add-bulk"),this.stickyHeaderElement=document.querySelector("sticky-header"),this.getTableHead(),this.getTotalBar(),this.stickyHeaderElement&&(this.stickyHeader={height:this.stickyHeaderElement.offsetHeight,type:""+this.stickyHeaderElement.getAttribute("data-sticky-type")}),this.getTotalBar()&&(this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,window.addEventListener("resize",()=>{this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,this.stickyHeader.height=this.stickyHeaderElement?this.stickyHeaderElement.offsetHeight:0})),new URLSearchParams(window.location.search));window.pageNumber=decodeURIComponent(e.get("page")||""),t.addEventListener("submit",this.onSubmit.bind(this)),this.addMultipleDebounce()}cartUpdateUnsubscriber=void 0;onSubmit(t){t.preventDefault()}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,t=>{let e=[];this.querySelectorAll(".variant-item").forEach(t=>{e.push(parseInt(t.dataset.variantId))}),t.source!==this.quickOrderListId&&t.cartData.items?.some(t=>e.includes(t.variant_id))&&this.refresh().then(()=>{this.defineInputsAndQuickOrderTable(),this.addMultipleDebounce()})}),this.sectionId=this.dataset.section}disconnectedCallback(){this.cartUpdateUnsubscriber?.()}defineInputsAndQuickOrderTable(){this.allInputsArray=Array.from(this.querySelectorAll('input[type="number"]')),this.quickOrderListTable=this.querySelector(".quick-order-list__table"),this.quickOrderListTable.addEventListener("focusin",this.switchVariants.bind(this))}onChange(t){var e=parseInt(t.target.value);this.cleanErrorMessageOnType(t),0==e?this.startQueue(t.target.dataset.index,e):this.validateQuantity(t)}cleanErrorMessageOnType(t){t.target.addEventListener("keydown",()=>{t.target.setCustomValidity(" "),t.target.reportValidity()})}validateInput(t){return t.max?0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)<=parseInt(t.max)&&parseInt(t.value)%parseInt(t.step)==0:0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)%parseInt(t.step)==0}refresh(){return new Promise((e,i)=>{fetch(this.getSectionsUrl()+"?section_id="+this.sectionId).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector("#"+this.quickOrderListId);t&&(this.innerHTML=t.innerHTML),e()}).catch(t=>{console.error(t),i(t)})})}getSectionsToRender(){return[{id:this.quickOrderListId,section:document.getElementById(this.quickOrderListId).dataset.section,selector:`#${this.quickOrderListId} .js-contents`},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"quick-order-list-live-region-text-"+this.dataset.productId,section:"cart-live-region-text",selector:".shopify-section"},{id:`quick-order-list-total-${this.dataset.productId}-`+this.dataset.section,section:document.getElementById(this.quickOrderListId).dataset.section,selector:`#${this.quickOrderListId} .quick-order-list__total`},{id:"CartDrawer",selector:"#CartDrawer",section:"cart-drawer"}]}addMultipleDebounce(){this.querySelectorAll("quantity-input").forEach(t=>{var e=debounce(t=>{this.onChange(t)},100);t.addEventListener("change",e.bind(this))})}renderSections(r,e){this.ids.push(e),0===this.queue.filter(t=>e.includes(t.id)).length&&(this.getSectionsToRender().forEach(e=>{var t=document.getElementById(e.id);t&&t.parentElement&&t.parentElement.classList.contains("drawer")&&(0<r.items.length?t.parentElement.classList.remove("is-empty"):t.parentElement.classList.add("is-empty"),setTimeout(()=>{document.querySelector("#CartDrawer-Overlay").addEventListener("click",this.cart.close.bind(this.cart))}));let i=t&&t.querySelector(e.selector)?t.querySelector(e.selector):t;i&&(e.selector===`#${this.quickOrderListId} .js-contents`&&0<this.ids.length?this.ids.flat().forEach(t=>{i.querySelector("#Variant-"+t).innerHTML=this.getSectionInnerHTML(r.sections[e.section],"#Variant-"+t)}):i.innerHTML=this.getSectionInnerHTML(r.sections[e.section],e.selector))}),this.defineInputsAndQuickOrderTable(),this.addMultipleDebounce(),this.ids=[])}getTableHead(){return document.querySelector(".quick-order-list__table thead")}getTotalBar(){return this.querySelector(".quick-order-list__total")}scrollQuickOrderListTable(){var t,e,i,r=this.variantListInput.getBoundingClientRect().top,s=this.variantListInput.getBoundingClientRect().bottom;this.isListInsideModal?(t=s>this.getTotalBar().getBoundingClientRect().top,e=r<this.getTableHead().getBoundingClientRect().bottom,(t||e)&&this.scrollToCenter()):(t=this.stickyHeaderElement&&this.stickyHeaderElement.getBoundingClientRect().bottom,e=s>this.totalBarPosition,s=s<this.inputFieldHeight,i=this.stickyHeaderElement&&"on-scroll-up"!==this.stickyHeader.type&&this.stickyHeader.height>r,r=this.stickyHeaderElement&&"on-scroll-up"===this.stickyHeader.type&&this.stickyHeader.height>r&&0<t,(e||s||i||r)&&this.scrollToCenter())}scrollToCenter(){this.variantListInput.scrollIntoView({block:"center",behavior:"smooth"})}switchVariants(t){"INPUT"===t.target.tagName&&(this.variantListInput=t.target,this.variantListInput.select(),1!==this.allInputsArray.length?(this.variantListInput.addEventListener("keydown",t=>{var e;"Enter"===t.key&&(t.preventDefault(),t.target.blur(),this.validateInput(t.target))&&(e=this.allInputsArray.indexOf(t.target),this.lastKey=t.shiftKey,(t.shiftKey?(t=this.allInputsArray[e-1]||this.allInputsArray[this.allInputsArray.length-1],this.lastElement=t.dataset.index,t):this.allInputsArray[e+1]||this.allInputsArray[0]).select())}),this.scrollQuickOrderListTable()):this.variantListInput.addEventListener("keydown",t=>{"Enter"===t.key&&(t.preventDefault(),t.target.blur())}))}updateMultipleQty(t){this.querySelector(".variant-remove-total .loading__spinner")?.classList.remove("hidden");let e=Object.keys(t);t=JSON.stringify({updates:t,sections:this.getSectionsToRender().map(t=>t.section),sections_url:this.dataset.url});this.updateMessage(),this.setErrorMessage(),fetch(""+routes.cart_update_url,{...fetchConfig(),body:t}).then(t=>t.text()).then(t=>{t=JSON.parse(t);this.renderSections(t,e),publish(PUB_SUB_EVENTS.cartUpdate,{source:this.quickOrderListId,cartData:t})}).catch(()=>{this.setErrorMessage(window.cartStrings.error)}).finally(()=>{this.querySelector(".variant-remove-total .loading__spinner")?.classList.add("hidden"),this.requestStarted=!1})}setErrorMessage(i=null){this.errorMessageTemplate=this.errorMessageTemplate??document.getElementById("QuickOrderListErrorTemplate-"+this.dataset.productId).cloneNode(!0),document.querySelectorAll(".quick-order-list-error").forEach(t=>{var e;t.innerHTML="",i&&((e=this.errorMessageTemplate.cloneNode(!0)).content.querySelector(".quick-order-list-error-message").innerText=i,t.appendChild(e.content))})}updateMessage(t=null){var r=this.querySelectorAll(".quick-order-list__message-text"),s=this.querySelectorAll(".quick-order-list__message-icon");if(null===t||isNaN(t))r.forEach(t=>t.innerHTML=""),s.forEach(t=>t.classList.add("hidden"));else{var a=t<0;let e=Math.abs(t),i=a?1===e?window.quickOrderListStrings.itemRemoved:window.quickOrderListStrings.itemsRemoved:1===t?window.quickOrderListStrings.itemAdded:window.quickOrderListStrings.itemsAdded;r.forEach(t=>t.innerHTML=i.replace("[quantity]",e)),a||s.forEach(t=>t.classList.remove("hidden"))}}updateError(t,e){let i="";i=void 0===t?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",t),this.updateLiveRegions(e,i)}cleanErrors(t){}updateLiveRegions(t,e){var i=document.getElementById("Quick-order-list-item-error-desktop-"+t),t=document.getElementById("Quick-order-list-item-error-mobile-"+t);i&&(i.querySelector(".variant-item__error-text").innerHTML=e,i.closest("tr").classList.remove("hidden")),t&&(t.querySelector(".variant-item__error-text").innerHTML=e),this.variantItemStatusElement.setAttribute("aria-hidden",!0);let r=document.getElementById("quick-order-list-live-region-text");r.setAttribute("aria-hidden",!1),setTimeout(()=>{r.setAttribute("aria-hidden",!0)},1e3)}toggleLoading(t,e){var i=this.querySelectorAll(`#Variant-${t} .loading__spinner`),t=this.querySelector("#Variant-"+t);e?(t.classList.add("quick-order-list__container--disabled"),[...i].forEach(t=>t.classList.remove("hidden")),this.variantItemStatusElement.setAttribute("aria-hidden",!1)):(t.classList.remove("quick-order-list__container--disabled"),i.forEach(t=>t.classList.add("hidden")))}});